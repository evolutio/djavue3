---
description: Arquitetura Vue 3 - Router â†’ Pages â†’ Store â†’ API Client
globs:
  - "frontend/src/**/*.{js,vue}"
alwaysApply: false
---

# ðŸŽ¨ Arquitetura Vue 3 - DjaVue

## Fluxo de Dados

O DjaVue segue uma arquitetura clara de fluxo de dados:

```
Router â†’ Pages â†’ Store â†’ API Client â†’ Backend
   â†“       â†“       â†“
Layouts Components
```

## Camadas

### 1. Router (`router/`)
- **Responsabilidade**: Definir rotas e navegaÃ§Ã£o
- **OrganizaÃ§Ã£o**: Um arquivo por contexto (ex: `accounts.routes.js`, `tasks.routes.js`)
- **Regras**:
  - Rotas organizadas por contexto de negÃ³cio
  - Usar layouts apropriados
  - Nomes de rotas: `[context]-[action]` (ex: `accounts-login`)
  - Importar e centralizar no `router/index.js`

**Exemplo**:
```javascript
// router/accounts.routes.js
import EmptyLayout from "@/layouts/default/EmptyLayout.vue"
import LoginView from "@/pages/accounts/LoginView.vue"

export default [
  {
    path: "/accounts",
    component: EmptyLayout,
    children: [
      {
        path: "login",
        name: "accounts-login",
        component: LoginView,
      },
    ],
  },
]
```

### 2. Pages (`pages/`)
- **Responsabilidade**: PÃ¡ginas/Views da aplicaÃ§Ã£o
- **OrganizaÃ§Ã£o**: Uma pasta por contexto (ex: `accounts/`, `tasks/`)
- **Regras**:
  - Nomenclatura: `[Nome]View.vue` (ex: `LoginView.vue`, `TaskListView.vue`)
  - Usar composables do Pinia para estado
  - Chamar actions das stores para operaÃ§Ãµes
  - Componentes reutilizÃ¡veis em `components/`

**Exemplo**:
```vue
<template>
  <div>
    <TaskForm @submit="handleAddTask" />
    <TaskList :tasks="tasks" />
  </div>
</template>

<script>
import { useTasksStore } from "@/stores/tasksStore"

export default {
  setup() {
    const tasksStore = useTasksStore()
    
    return {
      tasks: tasksStore.tasks,
      handleAddTask: tasksStore.addTask,
    }
  },
}
</script>
```

### 3. Store (`stores/`)
- **Responsabilidade**: Gerenciamento de estado global (Pinia)
- **OrganizaÃ§Ã£o**: Um arquivo por contexto (ex: `accountsStore.js`, `tasksStore.js`)
- **Regras**:
  - Nomenclatura: `use[Nome]Store` (ex: `useAccountsStore`)
  - State: dados reativos
  - Actions: mÃ©todos assÃ­ncronos que chamam API
  - Getters: dados computados (opcional)

**Exemplo**:
```javascript
import { defineStore } from "pinia"
import TasksApi from "@/api/tasks.api.js"

export const useTasksStore = defineStore("tasksStore", {
  state: () => ({
    tasks: [],
    loading: false,
  }),
  actions: {
    async getTasks() {
      this.loading = true
      const response = await TasksApi.getTasks()
      this.tasks = response.tasks
      this.loading = false
    },
    async addTask(description) {
      const newTask = await TasksApi.addTask(description)
      this.tasks.push(newTask)
      return newTask
    },
  },
})
```

### 4. API Client (`api/`)
- **Responsabilidade**: ComunicaÃ§Ã£o com o backend
- **OrganizaÃ§Ã£o**: Um arquivo por contexto (ex: `accounts.api.js`, `tasks.api.js`)
- **Regras**:
  - Usar instÃ¢ncia configurada do Axios (`api/config.js`)
  - FunÃ§Ãµes assÃ­ncronas que retornam dados
  - Nomenclatura: `[action][Entity]` (ex: `getTasks()`, `addTask()`)
  - Sempre usar `/api/` como prefixo nas rotas

**Exemplo**:
```javascript
import api from "./config.js"

export default {
  getTasks: async () => {
    const response = await api.get("/api/tasks/list")
    return response.data
  },
  addTask: async (description) => {
    const response = await api.post("/api/tasks/add", { description })
    return response.data
  },
}
```

### 5. Components (`components/`)
- **Responsabilidade**: Componentes reutilizÃ¡veis
- **Regras**:
  - Nomenclatura: `PascalCase` (ex: `TaskForm.vue`, `AppNavBar.vue`)
  - Prefixo `App` para componentes globais (ex: `AppFooter.vue`)
  - Props com validaÃ§Ã£o de tipo
  - Emitir eventos para comunicaÃ§Ã£o com pai

**Exemplo**:
```vue
<template>
  <v-form @submit.prevent="handleSubmit">
    <v-text-field v-model="description" label="Description" />
    <v-btn type="submit">Add</v-btn>
  </v-form>
</template>

<script>
export default {
  name: "TaskForm",
  emits: ["submit"],
  data() {
    return {
      description: "",
    }
  },
  methods: {
    handleSubmit() {
      this.$emit("submit", { description: this.description })
      this.description = ""
    },
  },
}
</script>
```

### 6. Layouts (`layouts/`)
- **Responsabilidade**: Layouts reutilizÃ¡veis para pÃ¡ginas
- **Regras**:
  - Organizar em `layouts/default/`
  - Usar `<router-view />` para conteÃºdo das pÃ¡ginas
  - Exemplos: `EmptyLayout.vue`, `DefaultLayout.vue`

**Exemplo**:
```vue
<template>
  <div>
    <AppNavBar />
    <main>
      <router-view />
    </main>
    <AppFooter />
  </div>
</template>
```

## ConvenÃ§Ãµes

### Nomenclatura
- **Componentes**: `PascalCase` (ex: `TaskForm.vue`)
- **Arquivos**: `camelCase` para JS, `PascalCase` para Vue (ex: `tasksStore.js`, `LoginView.vue`)
- **VariÃ¡veis/FunÃ§Ãµes**: `camelCase` (ex: `getTasks()`, `isLoading`)
- **Constantes**: `UPPER_SNAKE_CASE` (ex: `API_BASE_URL`)

### ImportaÃ§Ãµes
- Usar aliases: `@/` para `src/`
- Agrupar imports: Vue, plugins, componentes, stores, utils
- Ordem: externos â†’ internos

**Exemplo**:
```javascript
// Externos
import { defineStore } from "pinia"

// Internos
import TasksApi from "@/api/tasks.api.js"
import { useAccountsStore } from "@/stores/accountsStore"
```

### Estado
- Usar Pinia para estado global
- Estado local com `data()` ou `ref()` (Composition API)
- NÃ£o modificar estado diretamente, usar actions

### ComunicaÃ§Ã£o
- **Pai â†’ Filho**: Props
- **Filho â†’ Pai**: Events (`$emit`)
- **IrmÃ£os/Global**: Store (Pinia)
- **API**: API Client â†’ Store â†’ Component

## Estrutura de Arquivos

```
frontend/src/
â”œâ”€â”€ api/              # API Client (por contexto)
â”œâ”€â”€ stores/           # Pinia stores (por contexto)
â”œâ”€â”€ router/           # Rotas (por contexto)
â”œâ”€â”€ pages/            # PÃ¡ginas/Views (por contexto)
â”œâ”€â”€ components/       # Componentes reutilizÃ¡veis
â”œâ”€â”€ layouts/          # Layouts
â”œâ”€â”€ plugins/          # Plugins Vue
â”œâ”€â”€ settings/         # ConfiguraÃ§Ãµes
â””â”€â”€ main.js           # Entry point
```
